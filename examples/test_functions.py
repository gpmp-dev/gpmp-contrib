'''
Test functions
These test functions takes inputs defined on [0, 1]^2
For each function the inputs are suitable scaled from [0, 1]^2 --> original input space
'''
import numpy as np


def f1(x):
    '''
    original input space: [-1,0] x [0,1]
    '''
    x1 = x[:, 0] - 1 
    x2 = x[:, 1]
    return 780000 + 110000*x1 - 12000*x2 - 36000*x1*x2 + 280000*(x1**2) + 50000*(x2**2)

def f2(x):
    '''
    original input space: [-1,0] x [0,1]
    '''
    x1 = x[:, 0] - 1 
    x2 = x[:, 1]
    return 0.83 + 0.17*x1 - 0.015*x2 - 0.0038*x1*x2 + 0.061*(x1**2) + 0.0011*(x2**2)

def f3(x):
    '''
    original input space: [-5,5] x [-5,5]
    '''
    x1 = x[:, 0]*10 - 5 
    x2 = x[:, 1]*10 - 5
    return np.exp(0.36*(x1+x2)) + 0.6*x1 + 1.2*(x2**2) + 3*np.sin(0.8*np.pi*x1)

def f4(x):
    '''
    original input space: [-5,10] x [0,15]
    '''
    x1 = x[:, 0]*15 - 5 
    x2 = x[:, 1]*15 
    a = 5.1/(4*np.pi**2)
    b = 5/np.pi
    c = 10*(1-(1/(8*np.pi))) 
    return (x2 - a*x1**2 + b*x1 - 6)**2 + c*np.cos(x1) + 10

def f5(x):
    '''
    original input space: [-5,5] x [-5,5]
    '''
    x1 = x[:, 0]*10 - 5 
    x2 = x[:, 1]*10 - 5
    return 100*(x2 - x1**2)**2 + (1 - x1)**2

def f_gen(index):
    cst_dict = {6 : (0.63, 8.1, 7.5, -83, 26, -80, -440, 94, 920, 930),
                7 : (0.68, -9.4, 9.1, -2.9, -60, 72, 160, -830, -580, -920),
                8 : (0.094, -7.2, 7, 49, 68, -49, 630, -510, 860, -300),
                9 : (0.61, 5, 2.3, -5.3, 30, -66, -170, -99, -830, 430),
                10 : (-0.38, 8.5, 1.4, 63, 81, 96, -120, -780, -480, -180),
                11 : (-0.19, 4.8, 2.1, 42, 56, 77, 410, 360, 150, -16),
                12 : (0.78, 6, -4.7, 90, -85, -82, 600, 890, 370, -740),
                13 : (-0.45, 7.8, -7.7, 28, 34, -31, -500, -170, -480, 530),
                14 : (-0.45, -9.3, -3.5, 14, -9.7, 22, -880, -370, 550, 390),
                15 : (0.75, 7.4, -8.2, -98, 15, -31, -450, -62, 780, -260)}

    shift_dict = {6 : (0.5, 0.5),
                  7 : (0.5, 0.5), 
                  8 : (0.5, 0.5), 
                  9 : (0.5, 0.5),
                  10 : (0.5, 0.5),
                  11 : (0.5, 0.5),
                  12 : (0.3, 0.8),
                  13 : (0.6, 0.6),
                  14 : (0.3, 0.8),
                  15 : (0.3, 0.8)}
    
    s1, s2 = shift_dict[index]
    c1, c2, c3, c4, c5, c6, c7, c8, c9, c10 = cst_dict[index]

    def f(x):
        '''
        original input space: [0,1] x [0,1]
        '''
        x1 = x[:, 0]-s1
        x2 = x[:, 1]-s2
        return c1 + c2*x1 + c3*x2 + c4*x1*x2 + c5*x1**2 + c6*x2**2 + c7*x2*x1**2 + c8*x1*x2**2 + c9*x1**3 + c10*x2**3

    return f
